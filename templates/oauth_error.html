{% extends 'layout.html' %}

{% block title %}Authorization Error{% endblock %}

{% block head %}
<style>
  .error-header { text-align: center; margin-bottom: 30px; }
  .error-icon { color: #ea4335; font-size: 4em; margin-bottom: 10px; }
  .error-info { background-color: #fce8e6; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #ea4335; }
  .troubleshooting { background-color: #e8f0fe; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #1a73e8; }
  .code { background-color: #f8f9fa; border: 1px solid #e1e4e8; border-radius: 6px; padding: 8px 12px; font-family: monospace; display:inline-block; }
  .details { background-color:#f8f9fa; padding:15px; border-radius:6px; font-family:monospace; margin:15px 0; word-break:break-word }
</style>
{% endblock %}

{% block content %}
  <div class="container">
    <div class="error-header">
      <div class="error-icon">‚ùå</div>
      <h1>Authorization Failed</h1>
      <p>There was a problem connecting your account.</p>
    </div>

    <div class="error-info">
      <h3>Error Details</h3>
      <p><strong>{{ error_message or error }}</strong></p>
      {% if error_details %}
        <div class="details">{{ error_details }}</div>
      {% endif %}
    </div>

    {% if troubleshooting %}
      <div class="troubleshooting">
        <h3>How to Fix This</h3>
        {% if troubleshooting.error_type == 'redirect_uri_mismatch' %}
          <p>The redirect URI in your request doesn't match what's configured in Google Cloud Console.</p>
          <div class="solution-steps">
            <div class="step">Go to <a href="{{ troubleshooting.google_cloud_console }}" target="_blank">Google Cloud Console</a></div>
            <div class="step">Add this URI to "Authorized redirect URIs": <br><span class="code">{{ troubleshooting.check_uri }}</span></div>
          </div>
        {% else %}
          <p><strong>Solution:</strong> {{ troubleshooting.solution }}</p>
          {% if troubleshooting.details %}
            <div class="details">{{ troubleshooting.details }}</div>
          {% endif %}
        {% endif %}
      </div>
    {% endif %}

    <div class="actions">
      <a href="/auth" class="btn">Try Again</a>
    </div>
  </div>
{% endblock %}